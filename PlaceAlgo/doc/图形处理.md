Re2l: An efficient output-sensitive algorithm for computing Boolean operations on circular-arc polygons and its applications

https://www.sciencedirect.com/science/article/pii/S0010448516300677

https://doi.org/10.1016/j.cad.2016.07.004

一种高效的输出敏感圆弧形多边形布尔运算算法及其应用

# 1. 摘要

圆锥多边形( conic polygons )的边界由圆锥段或二次曲线构成。圆锥多边形有两种退化或特殊情况:线性多边形和圆弧多边形。自然问题——线性多边形上的布尔运算——已经被广泛地研究过。令人惊讶的是，(几乎)没有一篇文章关注圆弧多边形上的布尔运算问题，但这可能有许多应用。这意味着，如果有一个针对圆弧多边形布尔运算的目标解决方案，它应该有利于潜在用户。在本文中，我们设计了一个简洁的数据结构，然后开发了一个名为Re2l的目标算法，以此来弥补这个差距。我们的方法简单，易于实现，但不会损失效率。给定两个圆弧分别与m和n边多边形,我们的方法在O  (m + n + (l + k)日志l),使用O (m + n +  k)空间,k是十字路口的数量,和l的数量相关边缘(定义在第五节)。我们的算法具有近似线性复杂度的权力当k和l很小。通过实证研究，验证了所提算法的优越性。特别地，我们的方法是独立的兴趣，我们证明它可以很容易地扩展到计算布尔运算的其他类型的多边形

# 2. 介绍

​		多边形布尔运算是计算机图形学中最古老和最著名的问题之一，由于其公式简单，在计算几何、CAD、GIS、可视化计算、运动规划等各个学科中都有广泛的应用，因此受到了广泛的关注【1-8】。当待加工多边形为圆锥多边形(其边界由圆锥段或二次曲线构成)时，研究人员已经做出了一些努力，如【9-11】。圆锥多边形有几种特殊或退化的情况:(i)线性多边形(称为传统多边形)，也就是通常意义下的多边形，由直线段围成的一个多边形； (ii)圆弧多边形，其边界由圆弧和/或直线段组成。自然问题——传统多边形上的布尔运算——已被广泛研究【5，12--22】。然而，在现有的文献中(几乎)没有文章关注另一个自然问题-对圆弧多边形的布尔运算。然而，圆弧多边形上的布尔运算也有许多应用。例如，部署传感器以确保无线覆盖是一个重要的问题【23-24】。单个传感器的传感范围为一个圆。采用多边形障碍物，将其感知范围截断，形成圆弧形多边形。在验证传感器的无线覆盖范围时，需要对圆弧多边形进行布尔运算。再举一个例子，假设有一组用于监控超市的自由旋转摄像机。由于摄像机是自由旋转的，所以单个摄像机的视距可以看作是一个圆。各种各样的障碍物，如货架，通常妨碍相机的视觉;这里可以使用布尔运算来检查盲角。最后但并非最不重要的是，考虑一组自由移动的机器人用于在博物馆中引导游客。由于单个机器人的能量是有限的，它的活动范围被限制在一个圈内。在展品等各种障碍物的影响下，原有的活动区域受到障碍物的限制。当我们验证博物馆的每个地方是否都能被至少一个机器人服务时，还需要对圆弧多边形进行布尔运算。

​		尽管用于处理二次曲线(或更一般的)多边形的解决方案也适用于特殊情况，但是，这些情况通常有其独特的性质;直接执行用于处理二次曲线(或更一般的)多边形的算法通常不够有效。这就像当应用程序只涉及传统多边形时，我们通常倾向于使用针对传统多边形的解决方案，而不是那些针对圆锥(或更一般的)多边形的解决方案。使用类似的论点，当应用程序只涉及圆弧多边形时，针对圆弧多边形的目标解决方案应该有利于潜在用户。

​		基于此，本文研究了圆弧多边形上的布尔运算问题。我们特别感兴趣的是开发具有以下特点的算法:(i)易于实现，便于在实践中部署，(ii)有良好的理论保证。为此，首先自然地开发了一个简洁且易于操作的数据结构(第4.1节)。基于这个简洁的结构，我们提出了一个称为Re2l的算法，它由三个主要步骤组成。

​		第一步是Re2l的内核，它产生两个特殊的序列列表。具体来说，内核集成了三种简单而高效的策略:(1)引入了相关边的概念，尽可能地避免了不相关的计算;(ii)它使用两个特殊的序列表。每一个都是有三个区域的复合结构。它们使得分解后的弧线、交点和处理后的相关边得到了很好的组织，大大简化了后续的计算;(iii)在将边缘放入平衡树之前，为每条处理过的相关边分配两个标签;这有助于避免“假”交叉口被报告，并加快将报告的交叉口插入到相应的边的过程(章节5)。第二步生成两个新的链表，其中交叉口、附录点和原始顶点已经被安排，分解的弧被合并了。为了获得这两个新的链表，我们解决了两个重要但容易被忽视的问题，“插入新的附录点”和“合并分解的弧”(第6节)。第三步是通过遍历这两个新的链表来获得结果(或输出)多边形。为了正确地遍历它们，很自然地采用了entry-exit属性，并发展了三条遍历规则(第7节)。

​		从宏观角度看,类似于许多方法(见例如,[25日,15日,12日,22日,13日,16])的文学,我们的解决方案也部分地继承了两个著名的建议:Bentley-Ottmann平面扫描算法[26]和[6]Weiler-Atherton剪裁算法,而我们也从各个方面推进现有的结果。总之，我们做出了以下主要贡献。

1. 指出圆弧多边形是圆锥多边形的一种特殊情况，圆弧多边形上的布尔运算也有许多应用。
2. 我们设计了一个简洁、易于操作的数据结构，并开发了一个针对圆弧多边形布尔运算的目标算法
3. 虽然本文的重点是圆弧多边形的布尔运算，但我们表明我们的技术可以很容易地扩展到计算其他类型的多边形的布尔运算(第9节)。
4. 我们对算法进行了严格而详细的理论分析。简而言之，给定两个边数分别为m和n的圆弧多边形，我们的算法运行时间为O(m+n+(l+k) logl)，使用O(m+n+  k)空间，其中k为交点数，l为相关边数(第8节)
5. 我们进行了大量的实验来证明我们的解决方案的效率和有效性(第10节)。

​		我们的工作有三方面的新意:据我们所知，这是第一次对圆弧多边形布尔运算的全面研究;(2)首次将“利用相关边”的思想应用于多边形的布尔运算，技术简单，具有实用价值;(iii)它是第一个输出敏感算法，具有接近多边形布尔运算的线性复杂度的潜力。

​		接下来，我们回顾了与我们的研究最相关的工作，然后介绍了我们的算法，包括严格的理论分析和广泛的实证研究。

## 2. 相关工作

​		为了便于表示，我们首先澄清几个技术术语。众所周知，有三种典型的布尔运算:交集、并和差。请注意，在许多文章中提到的多边形裁剪实际上是计算两个多边形[22]的差值。给定两个多边形，被裁剪的一个称为主体多边形;另一种通常称为剪辑多边形或剪辑窗口[15,25,22]。给定一个多边形，如果有一对不相邻的边彼此相交，这个多边形通常称为自交多边形[12,13,21]。本文中，传统多边形是指以直线段为边界的多边形，而圆弧多边形是指以圆弧段为边界，或以直线段和圆弧同时为边界的多边形。我们现在准备回顾与我们最相关的以前的工作。

### 2.1 传统多边形上的布尔运算

​		在现有的文献中，有许多研究传统多边形布尔运算的论文。例如，Sutherland-Hodgeman[25]提出了一种优雅的算法来处理剪辑多边形为凸的情况。Liang等[15]对剪辑多边形为矩形的情况进行了详细的分析。Andreev[12]提出了一种处理多边形有孔和自交情况的算法。Vatti[22]和Greiner-Hormann[13]提出了一种通用算法，可以处理带有孔洞和自交的凹多边形。之后，Liu等人[16]进一步优化了Greiner-Hormann算法。Rivero-Feito[21]基于单纯链的概念实现了多边形的布尔运算。Peng等人[19]也采用了单纯链，并改进了Rivero-Feito算法。最近，马丁内斯等人提出在交叉口处对边进行细分。这些工作为今后的研究奠定了坚实的基础。与这些研究相比，本文侧重于圆弧多边形的布尔运算，因此有所不同。

### 2.2 二次多边形/一般多边形上的布尔运算

​		在二次多边形的布尔运算方面也有一些研究。例如Berberich等人[9]提出利用平面扫掠法分解非x-单调曲线，计算线段排列，然后利用排列结果计算两个多边形的重叠，从而实现布尔运算。Gong等人[11]利用两个圆锥多边形之间的拓扑关系实现了圆锥多边形的布尔运算。这种方法不需要单调的圆锥弧段。这两种算法都能支持圆弧多边形的布尔运算，因为圆锥多边形是圆弧多边形的一般情况。					此外，计算几何算法库([Cgal](https://github.com/CGAL/cgal))还支持圆弧多边形的布尔运算。考察Cgal的源代码，我们发现它的思想是直接调用一般多边形的布尔运算算法，在Cgal中定义为GeneralPolygon_2。在某种程度上，一般多边形可以被认为是最普遍的情况，因为它的边可以是线段、圆弧、圆锥曲线、三次曲线，甚至更复杂的曲线。虽然Cgal中的算法本质与[9]中的算法基本相似(使用平面扫掠方法来计算交点，使用Dcel结构来表示多边形)，但Cgal是一个非常强大和有用的库，收集了许多经典思想。例如，E.[28]开发了一个曲面物体和相关操作的内核，目标是包含在Cgal中。请注意，Cgal项目本身也产生了许多不错的论文，其中提到了曲线多边形上的布尔运算;见例[10,29]，仅举几个例子。这些优秀的作品是我们学习的基石，给了我们很多的启发。

​		与这些作品相比，我们的作品至少在以下几个方面与他们的不同。首先，本文讨论了圆锥多边形的一种特殊情况。我们对其独特的属性进行了深入的研究，针对这种特殊情况设计了一个简洁的数据结构，并开发了一种有针对性的算法，其中提出了“利用相关边”(伴随着一组精心设计的策略)的中心思想。据我们所知，这是第一次在多边形上使用这种技术进行布尔运算。并对算法进行了严格的理论分析。这个算法运行在O  (m + n + (l + k)日志l),和接近线性复杂度当k和l都很小(注意:最著名的结果多边形布尔运算在O ((m + n + k)日志(m +  n)),这并不比linearithmic时间即使k很小);其优越性也得到了大量实验的验证。

# 3.解决方案概述

























